<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>School of Rock ‚Äì HubSpot Forms Architecture & Discovery Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0b0c10;
      --bg-elevated: #101118;
      --bg-soft: #14151f;
      --accent: #e92b2d;
      --accent-soft: rgba(233, 43, 45, 0.2);
      --accent-2: #ff6b7a;
      --text: #f8fafc;
      --muted: #aeb6c1;
      --border-subtle: #1f222b;
      --danger: #f25f6b;
      --radius-lg: 18px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.75);
      --sor-blue: #3b82f6;
      --metajive-purple: #8b5cf6;
      --both-orange: #f59e0b;
      --answered-green: #22c55e;
      --pending-red: #ef4444;
      --partial-yellow: #eab308;
      scroll-behavior: smooth;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
      background: radial-gradient(circle at 18% 18%, rgba(233, 43, 45, 0.18), transparent 32%), radial-gradient(circle at 82% 20%, rgba(122, 30, 216, 0.16), transparent 26%), linear-gradient(180deg, #0b0c10 0%, #0f1119 42%, #0b0c10 100%);
      color: var(--text);
      font-size: 16px;
      line-height: 1.6;
    }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(18px);
      background: linear-gradient(to bottom, rgba(3, 7, 18, 0.95), rgba(3, 7, 18, 0.7));
      border-bottom: 1px solid rgba(15, 23, 42, 0.8);
    }

    .nav-inner {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0.8rem 1.6rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      border-top: 1px solid rgba(59, 72, 95, 0.35);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .brand-mark {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: conic-gradient(from 180deg, #d81e2d, #f25f6b, #6b46c1, #d81e2d);
      padding: 2px;
      box-shadow: 0 10px 30px rgba(216, 30, 45, 0.45);
    }

    .brand-mark-inner {
      width: 100%;
      height: 100%;
      border-radius: 8px;
      background: radial-gradient(circle at 30% 20%, rgba(248, 250, 252, 0.2), transparent 55%), #020617;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: #f25f6b;
      font-weight: 700;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }

    .brand-name {
      font-weight: 600;
      letter-spacing: 0.04em;
      font-size: 0.9rem;
      text-transform: uppercase;
    }

    .brand-sub {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .nav-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      font-size: 0.86rem;
    }

    .nav-links a {
      padding: 0.35rem 0.7rem;
      border-radius: 999px;
      border: 1px solid transparent;
      color: var(--muted);
      text-decoration: none;
      transition: all 0.16s ease-out;
      white-space: nowrap;
    }

    .nav-links a:hover {
      color: var(--text);
      border-color: rgba(148, 163, 184, 0.5);
      background: rgba(15, 23, 42, 0.85);
    }

    .nav-links a.primary {
      border-color: rgba(216, 30, 45, 0.55);
      background: radial-gradient(circle at top left, rgba(216, 30, 45, 0.32), rgba(15, 23, 42, 0.95));
      color: #fde8eb;
    }

    main {
      flex: 1;
    }

    .wrapper {
      max-width: 1280px;
      margin: 0 auto;
      padding: 1.7rem 1.6rem 2.9rem;
    }

    /* Hero */
    .hero {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.8fr);
      gap: 1.4rem;
      align-items: center;
      margin-top: 0.8rem;
      margin-bottom: 2.25rem;
    }

    @media (max-width: 860px) {
      .hero {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .hero-left {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .eyebrow {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.25rem 0.6rem;
      border-radius: var(--radius-pill);
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.9);
      font-size: 0.78rem;
      color: var(--muted);
    }

    .eyebrow-pill {
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      background: var(--accent-soft);
      color: #fde8eb;
      font-size: 0.74rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 600;
    }

    h1 {
      font-size: clamp(1.9rem, 3vw, 2.4rem);
      line-height: 1.12;
      margin: 0;
      letter-spacing: 0.01em;
    }

    .hero-sub {
      color: var(--text);
      font-size: 1.02rem;
      max-width: 38rem;
    }

    .hero-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.4rem;
    }

    .tag {
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(31, 41, 55, 0.9);
      font-size: 0.72rem;
      color: var(--muted);
    }

    .hero-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 1.25rem;
      margin-top: 0.8rem;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .hero-meta span strong {
      color: var(--text);
      font-weight: 600;
    }

    .hero-right {
      position: relative;
    }

    .hero-card {
      position: relative;
      background: radial-gradient(circle at top, rgba(216, 30, 45, 0.12), transparent 60%), linear-gradient(145deg, #0f1119, #0f1119 40%, #0b0c10 100%);
      border-radius: 24px;
      padding: 1.3rem 1.3rem 1rem;
      border: 1px solid rgba(59, 72, 95, 0.85);
      box-shadow: var(--shadow-soft);
      overflow: hidden;
    }

    .hero-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.9rem;
    }

    .hero-card-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .hero-pill {
      padding: 0.2rem 0.7rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.9);
      font-size: 0.72rem;
      color: var(--muted);
    }

    .hero-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.45rem;
      font-size: 0.8rem;
    }

    .hero-chip {
      border-radius: 999px;
      padding: 0.35rem 0.55rem;
      border: 1px solid rgba(51, 65, 85, 0.9);
      background: rgba(15, 23, 42, 0.9);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.3rem;
      color: var(--muted);
    }

    .hero-chip span {
      font-size: 0.7rem;
    }

    .hero-chip strong {
      font-size: 0.78rem;
      color: var(--accent-2);
      font-weight: 600;
    }

    .hero-footer {
      margin-top: 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.82rem;
      color: var(--muted);
    }

    .hero-status-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(233, 43, 45, 0.18);
      margin-right: 0.4rem;
    }

    /* Progress Tracker */
    .progress-tracker {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(59, 130, 246, 0.1));
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 16px;
      padding: 1rem 1.25rem;
      margin-top: 1rem;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .progress-count {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--answered-green);
    }

    .progress-label {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .progress-bar {
      height: 8px;
      background: rgba(15, 23, 42, 0.8);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--answered-green), var(--sor-blue));
      border-radius: 999px;
      transition: width 0.3s ease;
    }

    .data-controls {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.75rem;
      flex-wrap: wrap;
    }

    .data-btn {
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      border: 1px solid rgba(59, 72, 95, 0.8);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .data-btn:hover {
      color: var(--text);
      border-color: var(--sor-blue);
      background: rgba(59, 130, 246, 0.15);
    }

    .data-btn.danger:hover {
      border-color: var(--danger);
      background: rgba(242, 95, 107, 0.15);
    }

    /* Sections */
    section {
      margin-bottom: 2.4rem;
      scroll-margin-top: 96px;
    }

    section h2 {
      font-size: 1.32rem;
      margin: 0 0 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    section h2 span.badge {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(55, 65, 81, 0.9);
      color: var(--muted);
    }

    section p {
      margin: 0 0 0.75rem;
      font-size: 0.98rem;
      color: var(--muted);
      text-align: left;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 1.4rem;
    }

    @media (max-width: 900px) {
      .grid-2 {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: linear-gradient(140deg, rgba(16, 18, 24, 0.98), rgba(14, 16, 22, 0.94));
      border-radius: var(--radius-lg);
      border: 1px solid rgba(59, 72, 95, 0.8);
      padding: 1.1rem 1.15rem 1rem;
      box-shadow: 0 20px 60px rgba(6, 11, 25, 0.72);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.6rem;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 650;
      color: var(--text);
    }

    .pill {
      font-size: 0.7rem;
      padding: 0.2rem 0.6rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(51, 65, 85, 0.95);
      color: var(--muted);
      letter-spacing: 0.01em;
    }

    .list {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 0.94rem;
      color: var(--muted);
      text-align: left;
    }

    .list li {
      padding: 0.25rem 0;
      display: flex;
      gap: 0.45rem;
      align-items: flex-start;
    }

    .list li::before {
      content: "";
      margin-top: 0.4rem;
      width: 5px;
      height: 5px;
      border-radius: 999px;
      background: rgba(226, 232, 240, 0.9);
      flex-shrink: 0;
    }

    .list strong {
      color: var(--text);
      font-weight: 600;
      display: inline-block;
      min-width: 160px;
      max-width: 210px;
    }

    @media (max-width: 720px) {
      .list strong {
        min-width: 140px;
        max-width: 190px;
      }
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.35rem;
    }

    .pill-row span {
      font-size: 0.72rem;
      padding: 0.2rem 0.55rem;
      border-radius: 999px;
      border: 1px solid rgba(59, 72, 95, 0.8);
      background: rgba(15, 23, 42, 0.96);
      color: var(--muted);
    }

    .pill-row span.positive {
      border-color: rgba(216, 30, 45, 0.45);
      background: rgba(216, 30, 45, 0.16);
      color: #f8d7dd;
    }

    .pill-row span.risk {
      border-color: rgba(248, 113, 113, 0.45);
      background: rgba(248, 113, 113, 0.16);
      color: #fcdedf;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.6rem;
      font-size: 0.86rem;
    }

    .table th,
    .table td {
      padding: 0.45rem 0.6rem;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
    }

    .table th {
      text-align: left;
      font-weight: 600;
      color: var(--muted);
    }

    .table td.code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.82rem;
      color: #f8fafc;
    }

    .code-block {
      margin-top: 0.5rem;
      padding: 0.6rem 0.7rem;
      background: #020617;
      border-radius: 12px;
      border: 1px solid rgba(30, 64, 175, 0.85);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.82rem;
      color: #f8fafc;
      overflow-x: auto;
      max-height: 300px;
      white-space: pre;
    }

    .diagram {
      margin-top: 0.5rem;
      padding: 0.85rem 0.9rem;
      background: #0d101b;
      border-radius: 14px;
      border: 1px solid rgba(59, 72, 95, 0.9);
      box-shadow: var(--shadow-soft);
      overflow-x: auto;
      max-height: 220px;
    }

    .diagram-toggle {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.38rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.15s ease-out;
    }

    .diagram-toggle:hover {
      color: var(--text);
      border-color: rgba(233, 43, 45, 0.55);
      background: rgba(233, 43, 45, 0.16);
    }

    .diagram-toggle .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #d81e2d;
      box-shadow: 0 0 0 6px rgba(216, 30, 45, 0.18);
    }

    .diagram-note {
      font-size: 0.76rem;
      color: var(--muted);
      margin: 0.25rem 0 0.35rem;
    }

    .diagram-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(8px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .diagram-modal.active {
      display: flex;
    }

    .diagram-modal-content {
      background: #0b1020;
      border: 1px solid rgba(59, 72, 95, 0.95);
      border-radius: 16px;
      width: min(1200px, 92vw);
      height: min(780px, 88vh);
      box-shadow: 0 24px 70px rgba(0, 0, 0, 0.45);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .diagram-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.65rem 0.9rem;
      border-bottom: 1px solid rgba(59, 72, 95, 0.8);
      background: rgba(15, 23, 42, 0.8);
    }

    .diagram-modal-title {
      font-size: 0.92rem;
      color: var(--text);
    }

    .diagram-controls {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .diagram-btn {
      border: 1px solid rgba(59, 72, 95, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      border-radius: 10px;
      padding: 0.35rem 0.65rem;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.15s ease-out;
    }

    .diagram-btn:hover {
      color: var(--text);
      border-color: rgba(233, 43, 45, 0.55);
    }

    .diagram-modal-body {
      flex: 1;
      position: relative;
      background: radial-gradient(circle at 18% 20%, rgba(233, 43, 45, 0.12), transparent 35%), #050816;
      overflow: hidden;
    }

    .diagram-viewer {
      position: absolute;
      inset: 0;
      cursor: grab;
    }

    .diagram-viewer:active {
      cursor: grabbing;
    }

    .diagram-viewer-inner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      transform-origin: center center;
    }

    .code-label {
      font-size: 0.72rem;
      color: var(--muted);
      margin-bottom: 0.25rem;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      margin-top: 0.35rem;
      font-size: 0.74rem;
    }

    .badge-row span {
      padding: 0.18rem 0.55rem;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: rgba(15, 23, 42, 0.96);
      color: var(--muted);
      font-weight: 600;
    }

    .badge-row span.key {
      border-color: rgba(233, 43, 45, 0.7);
      background: rgba(233, 43, 45, 0.16);
      color: #fde8eb;
    }

    /* Interactive Question Styles */
    .question-item {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(59, 72, 95, 0.6);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      transition: all 0.2s ease;
    }

    .question-item:hover {
      border-color: rgba(59, 72, 95, 0.9);
    }

    .question-item.answered {
      border-color: rgba(34, 197, 94, 0.4);
      background: rgba(34, 197, 94, 0.05);
    }

    .question-header {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .question-check {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      accent-color: var(--answered-green);
      cursor: pointer;
    }

    .question-content {
      flex: 1;
    }

    .question-top {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-bottom: 0.35rem;
    }

    .owner-badge {
      font-size: 0.68rem;
      font-weight: 600;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .owner-badge.sor {
      background: rgba(59, 130, 246, 0.2);
      border: 1px solid rgba(59, 130, 246, 0.5);
      color: #93c5fd;
    }

    .owner-badge.metajive {
      background: rgba(139, 92, 246, 0.2);
      border: 1px solid rgba(139, 92, 246, 0.5);
      color: #c4b5fd;
    }

    .owner-badge.both {
      background: rgba(245, 158, 11, 0.2);
      border: 1px solid rgba(245, 158, 11, 0.5);
      color: #fcd34d;
    }

    .status-badge {
      font-size: 0.68rem;
      font-weight: 600;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
    }

    .status-badge.answered {
      background: rgba(34, 197, 94, 0.2);
      border: 1px solid rgba(34, 197, 94, 0.5);
      color: #86efac;
    }

    .status-badge.pending {
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.5);
      color: #fca5a5;
    }

    .question-text {
      font-size: 0.92rem;
      color: var(--text);
      line-height: 1.5;
    }

    .question-text strong {
      color: var(--accent-2);
    }

    .toggle-answer {
      margin-top: 0.5rem;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      border: 1px solid rgba(59, 72, 95, 0.6);
      background: transparent;
      color: var(--muted);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .toggle-answer:hover {
      border-color: var(--sor-blue);
      color: var(--text);
    }

    .answer-area {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid rgba(59, 72, 95, 0.4);
    }

    .answer-area textarea {
      width: 100%;
      min-height: 80px;
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid rgba(59, 72, 95, 0.6);
      background: rgba(2, 6, 23, 0.8);
      color: var(--text);
      font-family: inherit;
      font-size: 0.88rem;
      resize: vertical;
    }

    .answer-area textarea:focus {
      outline: none;
      border-color: var(--sor-blue);
    }

    .save-answer {
      margin-top: 0.5rem;
      padding: 0.4rem 1rem;
      border-radius: 6px;
      border: 1px solid var(--answered-green);
      background: rgba(34, 197, 94, 0.15);
      color: #86efac;
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .save-answer:hover {
      background: rgba(34, 197, 94, 0.25);
    }

    /* Decision Log */
    .decision-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.6rem 0;
      border-bottom: 1px solid rgba(59, 72, 95, 0.4);
    }

    .decision-item:last-child {
      border-bottom: none;
    }

    .decision-check {
      color: var(--answered-green);
      font-size: 1rem;
      margin-top: 2px;
    }

    .decision-text {
      font-size: 0.9rem;
      color: var(--muted);
    }

    .decision-text strong {
      color: var(--text);
    }

    /* Stakeholder section */
    .stakeholder-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .stakeholder-card {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(59, 72, 95, 0.5);
      border-radius: 12px;
      padding: 1rem;
    }

    .stakeholder-name {
      font-weight: 600;
      color: var(--text);
      margin-bottom: 0.25rem;
    }

    .stakeholder-role {
      font-size: 0.82rem;
      color: var(--muted);
      margin-bottom: 0.5rem;
    }

    .stakeholder-org {
      font-size: 0.75rem;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      display: inline-block;
    }

    .stakeholder-org.sor {
      background: rgba(59, 130, 246, 0.2);
      border: 1px solid rgba(59, 130, 246, 0.4);
      color: #93c5fd;
    }

    .stakeholder-org.metajive {
      background: rgba(139, 92, 246, 0.2);
      border: 1px solid rgba(139, 92, 246, 0.4);
      color: #c4b5fd;
    }

    .stakeholder-org.yeb {
      background: rgba(245, 158, 11, 0.2);
      border: 1px solid rgba(245, 158, 11, 0.4);
      color: #fcd34d;
    }

    footer {
      border-top: 1px solid rgba(15, 23, 42, 0.9);
      padding: 0.9rem 1.25rem 1.2rem;
      color: var(--muted);
      font-size: 0.78rem;
    }

    footer .footer-inner {
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      flex-wrap: wrap;
      align-items: center;
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="nav-inner">
        <div class="brand">
          <div class="brand-mark">
            <div class="brand-mark-inner">SoR</div>
          </div>
          <div class="brand-text">
            <div class="brand-name">HubSpot Forms Architecture</div>
            <div class="brand-sub">School of Rock ¬∑ Discovery Tracker</div>
          </div>
        </div>
        <nav class="nav-links">
          <a href="#scope">Scope</a>
          <a href="#architecture">Architecture</a>
          <a href="#data-model">Data Model</a>
          <a href="#flows">Flows</a>
          <a href="#implementation">Implementation</a>
          <a href="#risks">Risks</a>
          <a href="#discovery-questions" class="primary">Discovery Q&A</a>
        </nav>
      </div>
    </header>

    <main>
      <div class="wrapper">
        <!-- HERO -->
        <section class="hero" id="top">
          <div class="hero-left">
            <div class="eyebrow">
              <span class="eyebrow-pill">Discovery & CRM Architecture</span>
              <span>From iframe forms ‚Üí HubSpot forms ‚Üí Contact-first model</span>
            </div>
            <h1>
              School of Rock ‚Äì HubSpot Forms & Contact-Centric Lead Management
            </h1>
            <p class="hero-sub">
              This page summarizes the Metajive discovery scope, the target HubSpot architecture, and the
              end-to-end data flows between HubSpot, Bridge, and Pike13. Check items off as discovery progresses and capture answers directly on this page.
            </p>
            <div class="hero-tags">
              <span class="tag">Single HubSpot portal ¬∑ Franchise users</span>
              <span class="tag">Contact-first lifecycle</span>
              <span class="tag">Bridge ‚Üí Pike13 sync</span>
              <span class="tag">Multi-owner routing</span>
            </div>
            <div class="hero-meta">
              <span><strong>Client:</strong> School of Rock (YEB)</span>
              <span><strong>Partner:</strong> Metajive</span>
              <span><strong>Timeframe (Discovery):</strong> Dec 2025 ‚Äì Jan 2026</span>
            </div>

            <!-- Progress Tracker -->
            <div class="progress-tracker">
              <div class="progress-header">
                <div>
                  <span class="progress-count" id="progress-count">0 / 10</span>
                  <span class="progress-label"> questions answered</span>
                </div>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
              </div>
              <div class="data-controls">
                <button class="data-btn" onclick="exportData()">üì• Export JSON</button>
                <button class="data-btn" onclick="document.getElementById('import-file').click()">üì§ Import JSON</button>
                <button class="data-btn danger" onclick="clearAllData()">üóëÔ∏è Clear All</button>
                <input type="file" id="import-file" accept=".json" style="display:none" onchange="importData(event)">
              </div>
            </div>
          </div>

          <div class="hero-right">
            <div class="hero-card">
              <div class="hero-card-header">
                <div class="hero-card-title">System Snapshot</div>
                <div class="hero-pill">Contact ‚Üí Bridge ‚Üí Pike13</div>
              </div>
              <div class="hero-grid">
                <div class="hero-chip">
                  <span>Primary object</span>
                  <strong>Contact</strong>
                </div>
                <div class="hero-chip">
                  <span>Lead routing</span>
                  <strong>Location-based</strong>
                </div>
                <div class="hero-chip">
                  <span>Owners</span>
                  <strong>Multi-user</strong>
                </div>
                <div class="hero-chip">
                  <span>Forms</span>
                  <strong>HubSpot-native</strong>
                </div>
                <div class="hero-chip">
                  <span>Sync</span>
                  <strong>2-way (key fields)</strong>
                </div>
                <div class="hero-chip">
                  <span>Deals</span>
                  <strong>Trigger-based</strong>
                </div>
              </div>
              <div class="hero-footer">
                <div style="display:flex;align-items:center;gap:0.3rem;">
                  <span class="hero-status-dot"></span>
                  <span>Discovery-ready ‚Äì implementation follows SOW output.</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- SCOPE & GOALS -->
        <section id="scope">
          <h2>
            Scope & Goals
            <span class="badge">From SOW & SoR requirements</span>
          </h2>
          <div class="grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Metajive Discovery Scope (Summary)</div>
                <div class="pill">Time & Materials ¬∑ 40 hrs (max)</div>
              </div>
              <ul class="list">
                <li>Assess transition from iframe-based forms to HubSpot-native forms for School of Rock (move fully onto HubSpot native forms).</li>
                <li>Understand technical implications for the website and the Bridge layer into Pike13.</li>
                <li>Support stakeholder meetings and documentation of risks, scenarios, and approaches.</li>
                <li>Produce a future implementation SOW outlining technical approach and effort.</li>
              </ul>
              <div class="pill-row">
                <span class="positive">Discovery only</span>
                <span>Implementation of CRM strategy is out of scope</span>
                <span>API / integration build is out of scope</span>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <div class="card-title">SoR CRM Objectives</div>
                <div class="pill">Contact-first ¬∑ Franchise users</div>
              </div>
              <ul class="list">
                <li><strong>Move from Deal-first ‚Üí Contact-first:</strong> franchise users primarily work leads from the Contact record.</li>
                <li><strong>Use HubSpot forms:</strong> all public forms submit into HubSpot with a required Location field.</li>
                <li><strong>Multi-owner support:</strong> each Contact can be owned by multiple users via a dedicated multi-user property.</li>
                <li><strong>Bridge & Pike13 alignment:</strong> Bridge creates/links Pike13 contacts and deals based on HubSpot data and Location.</li>
              </ul>
              <div class="pill-row">
                <span class="positive">Respect Single Portal + Many Locations</span>
                <span class="positive">Avoid duplicate Contacts and Deals</span>
                <span class="risk">Avoid lifecycle moving backwards</span>
              </div>
            </div>
          </div>
        </section>

        <!-- ARCHITECTURE OVERVIEW -->
        <section id="architecture">
          <h2>
            Target Architecture
            <span class="badge">Contact-centric ¬∑ Location-aware ¬∑ Bridge-integrated</span>
          </h2>
          <div class="grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">High-Level Design</div>
                <div class="pill">Core principles</div>
              </div>
              <ul class="list">
                <li><strong>Contacts as source of truth:</strong> lifecycle, ownership, and location context live on the Contact.</li>
                <li><strong>Deals are derived, not primary:</strong> created only when specific triggers occur (trial, enrollment, etc.).</li>
                <li><strong>Location drives routing:</strong> every form submission includes a Location; routing and ownership rules use it as the anchor.</li>
                <li><strong>Multi-owner model:</strong> a single multi-user property tracks all relevant owners by location.</li>
                <li><strong>Automation directive field:</strong> a hidden text field encodes "what should happen next" for workflows and Bridge.</li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">System Interaction</div>
                <div class="pill">Web ‚Üí HubSpot ‚Üí Bridge ‚Üí Pike13</div>
              </div>
              <ul class="list">
                <li><strong>Form ‚Üí HubSpot:</strong> user submits HubSpot form; Location captured.</li>
                <li><strong>Contact is updated:</strong> ownership and lifecycle directive set on the Contact.</li>
                <li><strong>Tasks/Deals fire:</strong> workflows create tasks and optional deals per directive.</li>
                <li><strong>Bridge handoff:</strong> payload sent to Bridge with contact/deal + Location.</li>
                <li><strong>Pike13 sync:</strong> Bridge creates/links Pike13 records and returns IDs/status to HubSpot.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- DATA MODEL -->
        <section id="data-model">
          <h2>
            Data Model & Key Properties
            <span class="badge">Contacts ¬∑ Deals ¬∑ Location & Ownership</span>
          </h2>
          <div class="grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Contact Properties</div>
                <div class="pill">Routing, ownership, lifecycle</div>
              </div>
              <table class="table">
                <thead>
                  <tr>
                    <th>Label</th>
                    <th>Internal Name</th>
                    <th>Type</th>
                    <th>Notes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Multi form owner</td>
                    <td class="code">multi_form_owner</td>
                    <td>User (multi-select)</td>
                    <td>Holds all owners per Contact across locations; used for task/alert routing.</td>
                  </tr>
                  <tr>
                    <td>Location</td>
                    <td class="code">location</td>
                    <td>Dropdown (single-select)</td>
                    <td>Captured from HubSpot forms; drives routing and Bridge/Pike13 mapping. May need multi-select helper.</td>
                  </tr>
                  <tr>
                    <td>School location lifecycle details</td>
                    <td class="code">school_location_lifecycle_details</td>
                    <td>Single-line text</td>
                    <td>Encoded automation directive (lifecycle, alert, pipeline, location). One line per location.</td>
                  </tr>
                  <tr>
                    <td>Pike13 Contact ID(s)</td>
                    <td class="code">hs_object_id</td>
                    <td>Text</td>
                    <td>Use HubSpot <code>hs_object_id</code> as temporary anchor until a dedicated Pike13 ID field is defined.</td>
                  </tr>
                </tbody>
              </table>
              <div class="badge-row">
                <span class="key">Contacts = single canonical profile</span>
                <span>Location determines routing for each submission</span>
                <span>Owners are appended per location, not overwritten</span>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <div class="card-title">Automation Directive Format</div>
                <div class="pill">School location lifecycle details</div>
              </div>
              <p class="code-label">Recommended encoding:</p>
              <div class="code-block">
loc=DENVER_01; lifecycle=LEAD; alert=new_lead; pipeline=TRIAL
loc=BOULDER_02; lifecycle=MQL; alert=trial_followup; pipeline=ENROLLMENT
              </div>
              <p>
                This single-line field is populated by workflows and read by other workflows (and Bridge) to determine
                what should happen next: which task to create (same alert set across locations), whether to create a Deal,
                how to adjust lifecycle, and which pipeline to use.
              </p>
              <div class="badge-row">
                <span class="key">Set by automation only</span>
                <span>Human-readable and machine-parseable</span>
                <span>Safe to extend with new keys over time</span>
              </div>
            </div>
          </div>
        </section>

        <!-- FLOWS & DIAGRAMS -->
        <section id="flows">
          <h2>
            Key Flows & Diagrams
            <span class="badge">Mermaid-ready ¬∑ System & user perspectives</span>
          </h2>

          <div class="card" style="margin-bottom:1.4rem;">
            <div class="card-header">
              <div class="card-title">End-to-End Flow: Form ‚Üí Contact ‚Üí Tasks/Deals ‚Üí Bridge ‚Üí Pike13</div>
              <div class="pill">Technical view</div>
            </div>
            <div class="diagram-note" style="margin-bottom:0.4rem;">Preview below ¬∑ Open for zoom/pan</div>
            <button class="diagram-toggle diagram-open" data-target="diagram-endtoend" data-title="End-to-End Flow">
              <span class="dot"></span>
              <span>Open in modal</span>
            </button>
            <div class="diagram mermaid" id="diagram-endtoend">
flowchart LR
    subgraph UserSide["User/Website/BAT/SoR"]
        F1["Form submission<br/>Location selected"]
    end

    subgraph HubSpot["HubSpot"]
        D1{"Contact exists?"}
        CNew["Create contact"]
        CUpd["Update contact"]

        LStage["Set/keep lifecycle stage"]
        Loc["Set/update location"]
        Owners["Update multi_form_owner<br/>(location-based owners)"]
        Meta["Set lifecycle details<br/>(loc=..; lifecycle=..; alert=..; pipeline=..)"]

        subgraph Tasks["Task automation"]
            TNew["Create new lead task"]
            TExist["Create existing lead follow-up task"]
            TTrial["Create trial confirmation task"]
            TEnroll["Create enrollment task"]
            TDone["Task completed"]
            TUpdate["Update lifecycle & details"]
        end

        subgraph Deals["Deal automation"]
            DTrig{"Deal trigger?"}
            DCreate["Create trial/enrollment deal"]
        end
    end

    subgraph Bridge["Bridge service"]
        BSend["Send contact/deal payload<br/>to Bridge"]
        BCheck["Bridge checks Pike13<br/>(email + location)"]
        BCreateC["Create Pike13 contact<br/>if none exists"]
        BCreateD["Create/update Pike13 deal"]
        BSyncBack["Sync Pike13 IDs/status<br/>back to HubSpot"]
    end

    subgraph Pike13["Pike13"]
        PContact["Pike13 contact<br/>(per location)"]
        PDeal["Pike13 deal<br/>(trial / enrollment)"]
    end

    F1 --> D1
    D1 -- "No" --> CNew
    CNew --> LStage
    CNew --> Loc
    Loc --> Owners
    Owners --> Meta
    Meta --> BSend

    D1 -- "Yes" --> CUpd
    CUpd --> LStage
    CUpd --> Loc
    Loc --> Owners
    Owners --> Meta
    Meta --> BSend

    BSend --> BCheck
    BCheck -->|No match| BCreateC --> PContact
    BCheck -->|Existing| PContact

    BSend --> BCreateD --> PDeal
    PContact --> BSyncBack
    PDeal --> BSyncBack
    BSyncBack --> Meta

    Meta -->|"alert=new_lead"| TNew
    Meta -->|"alert=existing_lead"| TExist
    Meta -->|"alert=trial_followup"| TTrial
    Meta -->|"alert=enrollment_followup"| TEnroll

    TNew --> TDone
    TExist --> TDone
    TTrial --> TDone
    TEnroll --> TDone
    TDone --> TUpdate
    TUpdate --> Meta

    Meta --> DTrig
    DTrig -- "Yes" --> DCreate --> BSend
    DTrig -- "No" --> Meta
            </div>
          </div>

          <div class="grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Franchise User POV</div>
                <div class="pill">"What happens when a lead comes in?"</div>
              </div>
              <div class="diagram-note" style="margin-bottom:0.4rem;">Preview below ¬∑ Open for zoom/pan</div>
              <button class="diagram-toggle diagram-open" data-target="diagram-franchise" data-title="Franchise User POV">
                <span class="dot"></span>
                <span>Open in modal</span>
              </button>
              <div class="diagram mermaid" id="diagram-franchise" style="max-height:260px;">
flowchart TD
    subgraph HS["HubSpot"]
        FS["Form submitted<br/>with location"]
        Cx["Contact (new or existing)"]
        OwProp["multi_form_owner updated<br/>for that location"]
        Meta["School location lifecycle details<br/>(alert + lifecycle + pipeline)"]
        Task{"Which task type?"}
        TLead["Task: New lead"]
        TFollow["Task: Lead follow-up"]
        TTrial["Task: Trial confirmation"]
        TEnroll["Task: Enrollment"]
        TAssigned["Task assigned to franchise user"]
        TDone["Task completed"]
        LUpdate["Lifecycle & details updated"]
        DTrig{"Deal triggered?"}
        DCreate["Deal created<br/>(trial/enrollment)"]
    end

    subgraph Franchise["Franchise user"]
        ViewTasks["Views tasks in HubSpot"]
        Call["Calls/emails lead"]
        BookTrial["Books trial / enrollment"]
        CompleteTask["Marks task complete"]
    end

    FS --> Cx
    Cx --> OwProp --> Meta --> Task

    Task -->|new_lead| TLead
    Task -->|existing_lead| TFollow
    Task -->|trial_followup| TTrial
    Task -->|enrollment_followup| TEnroll

    TLead --> TAssigned
    TFollow --> TAssigned
    TTrial --> TAssigned
    TEnroll --> TAssigned

    TAssigned --> ViewTasks --> Call --> BookTrial --> CompleteTask --> TDone
    TDone --> LUpdate --> DTrig

    DTrig -- "Yes" --> DCreate
    DTrig -- "No" --> Cx
              </div>
              <p>
                This diagram is ideal for training franchise teams: it shows that they primarily work Tasks from Contacts,
                and Deals are created automatically when trials or enrollments occur.
              </p>
            </div>

            <div class="card">
              <div class="card-header">
                <div class="card-title">System Interaction</div>
                <div class="pill">Architecture overview</div>
              </div>
              <div class="diagram-note" style="margin-bottom:0.4rem;">Preview below ¬∑ Open for zoom/pan</div>
              <button class="diagram-toggle diagram-open" data-target="diagram-systems" data-title="Systems Overview">
                <span class="dot"></span>
                <span>Open in modal</span>
              </button>
              <div class="diagram mermaid" id="diagram-systems" style="max-height:260px;">
flowchart LR
    subgraph Web["Web properties"]
        Site["Website forms / BAT / SoR"]
    end

    subgraph HS["HubSpot CRM"]
        Forms["HubSpot forms"]
        Contacts["Contacts<br/>(multi_form_owner, location, lifecycle details)"]
        Deals["Deals<br/>(trial/enrollment)"]
        Tasks["Tasks & workflows"]
    end

    subgraph BR["Bridge"]
        BIngest["Ingest HubSpot payloads"]
        BLogic["Location & contact matching"]
        BToPike["Create/update Pike13 records"]
        BBack["Push IDs/status back"]
    end

    subgraph P13["Pike13"]
        PContacts["Pike13 contacts<br/>(per location)"]
        PDeals["Pike13 deals<br/>(per location)"]
    end

    Site --> Forms --> Contacts
    Contacts --> Tasks
    Contacts --> Deals

    Contacts --> BIngest
    Deals --> BIngest

    BIngest --> BLogic --> BToPike
    BToPike --> PContacts
    BToPike --> PDeals

    PContacts --> BBack
    PDeals --> BBack
    BBack --> Contacts
    BBack --> Deals
              </div>
              <p>
                Use this for technical review across engineering, Bridge, and product to align on handoff points and data
                contracts.
              </p>
            </div>
          </div>
        </section>

        <!-- IMPLEMENTATION PHASES -->
        <section id="implementation">
          <h2>
            Implementation Phases
            <span class="badge">From discovery ‚Üí build ‚Üí rollout</span>
          </h2>
          <div class="grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 1 ‚Äì Foundations</div>
                <div class="pill">Data model & forms</div>
              </div>
              <ul class="list">
                <li>Create and configure Contact properties (multi_form_owner, location, lifecycle details).</li>
                <li>Finalize Location taxonomy and mapping to Bridge/Pike13 identifiers.</li>
                <li>Design and implement HubSpot forms with required Location fields.</li>
                <li>Document owner mapping per Location for routing.</li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 2 ‚Äì Automation</div>
                <div class="pill">Workflows & tasking</div>
              </div>
              <ul class="list">
                <li>Build workflows for new vs existing Contacts on submission.</li>
                <li>Implement lifecycle directive encoding in School location lifecycle details.</li>
                <li>Configure task creation and task-completion automation.</li>
                <li>Configure deal-creation rules for trial and enrollment triggers.</li>
              </ul>
            </div>
          </div>
          <div class="grid-2" style="margin-top:1rem;">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 3 ‚Äì Bridge & Pike13 Enhancements</div>
                <div class="pill">2-way sync</div>
              </div>
              <ul class="list">
                <li>Update Bridge to consume new payloads (Location, owners, lifecycle details).</li>
                <li>Implement Pike13 contact/deal creation based on email + Location.</li>
                <li>Implement sync-back of Pike13 IDs and status into HubSpot contacts/deals.</li>
                <li>Define clear ownership rules when HubSpot vs Pike13 values differ.</li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Phase 4 ‚Äì Training & Reporting</div>
                <div class="pill">Rollout & measurement</div>
              </div>
              <ul class="list">
                <li>Train franchise users using the Franchise POV diagram and example records.</li>
                <li>Build dashboards for lead volume, response time, trial/ enrollment conversion by Location.</li>
                <li>Monitor duplicate creation, owner assignment accuracy, and lifecycle correctness.</li>
                <li>Iterate on workflows and directive encoding as new edge cases emerge.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- RISKS & OPEN ITEMS -->
        <section id="risks">
          <h2>
            Risks & Open Questions
            <span class="badge">To validate during discovery</span>
          </h2>
          <div class="grid-2">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Key Risks</div>
                <div class="pill">Assumptions to stress-test</div>
              </div>
              <ul class="list">
                <li><strong>Ownership ambiguity:</strong> clarity is required on how owners are mapped to locations and how conflicts will be resolved.</li>
                <li><strong>Lifecycle safety:</strong> rules must prevent unintended backwards movement (e.g., Customer ‚Üí Lead).</li>
                <li><strong>Duplicate handling:</strong> consistent matching logic (email + location) is needed across HubSpot and Bridge.</li>
                <li><strong>Bridge latency/failure:</strong> workflows must gracefully handle sync delays or errors from Bridge/Pike13.</li>
                <li><strong>Task overload:</strong> automation should avoid spamming users with low-value tasks.</li>
              </ul>
            </div>
            <div class="card">
              <div class="card-header">
                <div class="card-title">Open Decisions</div>
                <div class="pill">To finalize with stakeholders</div>
              </div>
              <ul class="list">
                <li>Exact internal naming / structure for Pike13 ID properties on Contacts and Deals (Bridge currently handles its own linking logic).</li>
                <li>Definition of "internal" forms and how they should behave (no lifecycle change, limited routing, etc.).</li>
                <li>Detailed field list for 2-way synced attributes (status tags, attendance, multi-program support).</li>
                <li>Whether to add an optional lightweight 3-stage Lead deal pipeline (lead handling is Contact-only for now).</li>
                <li>Long-term handling of multi-program enrollment and cross-location membership.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- ============================================ -->
        <!-- DISCOVERY Q&A SECTION (BOTTOM) -->
        <!-- ============================================ -->

        <!-- DISCOVERY QUESTIONS (Interactive) -->
        <section id="discovery-questions">
          <h2>
            Discovery Questions
            <span class="badge">Track answers during discovery</span>
          </h2>
          <p>Check items off as they're answered. Add notes in the answer fields. Data saves to your browser automatically.</p>

          <div class="card">
            <div class="card-header">
              <div class="card-title">Critical Questions (Block Implementation)</div>
              <div class="pill">Must answer before build</div>
            </div>

            <div class="question-item" data-id="q1">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q1')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge both">Both</span>
                    <span class="status-badge pending" id="status-q1">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Location ‚Üí Bridge/Pike13 ID mapping:</strong> How does each Location value map to Pike13 record owners/IDs? What is the canonical Location value list?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q1')">+ Answer</button>
                  <div class="answer-area" id="answer-q1" style="display:none;">
                    <textarea id="text-q1" placeholder="Enter answer..." onchange="saveAnswer('q1')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q1')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q2">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q2')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge metajive">Metajive</span>
                    <span class="status-badge pending" id="status-q2">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Pike13 ID field structure:</strong> Single ID field vs per-location IDs (array/JSON)? Where stored on Contact/Deal? How to append multiple IDs for cross-location contacts?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q2')">+ Answer</button>
                  <div class="answer-area" id="answer-q2" style="display:none;">
                    <textarea id="text-q2" placeholder="Enter answer..." onchange="saveAnswer('q2')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q2')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q3">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q3')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge metajive">Metajive</span>
                    <span class="status-badge pending" id="status-q3">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Bridge payload contract:</strong> Exact schema (Contact + optional Deal), required fields, response shape (IDs/status), idempotency key (email+location?), retry/error behavior.
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q3')">+ Answer</button>
                  <div class="answer-area" id="answer-q3" style="display:none;">
                    <textarea id="text-q3" placeholder="Enter answer..." onchange="saveAnswer('q3')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q3')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q4">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q4')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge sor">SoR</span>
                    <span class="status-badge pending" id="status-q4">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Forms inventory:</strong> Complete list of public vs internal forms. Which should bypass lifecycle/task/deal automation?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q4')">+ Answer</button>
                  <div class="answer-area" id="answer-q4" style="display:none;">
                    <textarea id="text-q4" placeholder="Enter answer..." onchange="saveAnswer('q4')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q4')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q5">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q5')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge metajive">Metajive</span>
                    <span class="status-badge pending" id="status-q5">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Cross-location membership:</strong> How does Bridge select/create the right Pike13 record when contact spans locations? Storage pattern for multiple Pike13 IDs?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q5')">+ Answer</button>
                  <div class="answer-area" id="answer-q5" style="display:none;">
                    <textarea id="text-q5" placeholder="Enter answer..." onchange="saveAnswer('q5')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q5')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top:1rem;">
            <div class="card-header">
              <div class="card-title">Important Questions (Needed for Build)</div>
              <div class="pill">Answer during discovery</div>
            </div>

            <div class="question-item" data-id="q6">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q6')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge sor">SoR</span>
                    <span class="status-badge pending" id="status-q6">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Owner roster per location:</strong> Complete list of primary/backup owners for each location. Escalation rules?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q6')">+ Answer</button>
                  <div class="answer-area" id="answer-q6" style="display:none;">
                    <textarea id="text-q6" placeholder="Enter answer..." onchange="saveAnswer('q6')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q6')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q7">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q7')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge sor">SoR</span>
                    <span class="status-badge pending" id="status-q7">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Task SLAs:</strong> Response time expectations per location. Throttling rules to avoid task spam?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q7')">+ Answer</button>
                  <div class="answer-area" id="answer-q7" style="display:none;">
                    <textarea id="text-q7" placeholder="Enter answer..." onchange="saveAnswer('q7')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q7')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q8">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q8')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge metajive">Metajive</span>
                    <span class="status-badge pending" id="status-q8">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Error handling:</strong> How should workflows handle Bridge latency/failures? Alerts, retry logic, manual queue?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q8')">+ Answer</button>
                  <div class="answer-area" id="answer-q8" style="display:none;">
                    <textarea id="text-q8" placeholder="Enter answer..." onchange="saveAnswer('q8')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q8')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q9">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q9')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge sor">SoR</span>
                    <span class="status-badge pending" id="status-q9">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Compliance/consent:</strong> Privacy messaging requirements on forms. Audit/logging needs?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q9')">+ Answer</button>
                  <div class="answer-area" id="answer-q9" style="display:none;">
                    <textarea id="text-q9" placeholder="Enter answer..." onchange="saveAnswer('q9')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q9')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="question-item" data-id="q10">
              <div class="question-header">
                <input type="checkbox" class="question-check" onchange="updateQuestion('q10')">
                <div class="question-content">
                  <div class="question-top">
                    <span class="owner-badge both">Both</span>
                    <span class="status-badge pending" id="status-q10">Pending</span>
                  </div>
                  <div class="question-text">
                    <strong>Lifecycle guardrails:</strong> Exact rules to prevent backwards movement (e.g., Customer ‚Üí Lead). Who can edit lifecycle/location/ownership?
                  </div>
                  <button class="toggle-answer" onclick="toggleAnswer('q10')">+ Answer</button>
                  <div class="answer-area" id="answer-q10" style="display:none;">
                    <textarea id="text-q10" placeholder="Enter answer..." onchange="saveAnswer('q10')"></textarea>
                    <button class="save-answer" onclick="saveAnswer('q10')">Save Answer</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- CONFIRMED DECISIONS -->
        <section id="decisions">
          <h2>
            Confirmed Decisions
            <span class="badge">Locked in during discovery</span>
          </h2>
          <div class="card">
            <div class="card-header">
              <div class="card-title">Decisions Made</div>
              <div class="pill">Reference during build</div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Location field type:</strong> Single-select dropdown. May need a multi-select helper property for contacts at multiple locations.
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Multi-owner behavior:</strong> APPEND only. Never clear the multi_form_owner field when contact moves or joins another location‚Äîthey could come back.
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Two-way sync to Pike13:</strong> Does NOT sync to Pike13. HubSpot is the source; Bridge pushes to Pike, not the reverse for these fields.
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Lead pipeline stages:</strong> New ‚Üí Waiting ‚Üí Contacted ‚Üí Won (creates deal if automation doesn't) ‚Üí Lost
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Deal creation trigger:</strong> Pike13/automation creates deals on trial/conversion. Automation handles this flow.
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Terminology:</strong> Use "lead status" (not "lifecycle") for per-location tracking in the multi-line field.
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Dedupe strategy:</strong> Use HubSpot dedupe (email) plus Location-aware logic in workflows/Bridge to avoid cross-location contamination.
              </div>
            </div>

            <div class="decision-item">
              <span class="decision-check">‚úì</span>
              <div class="decision-text">
                <strong>Permissions:</strong> Lifecycle/property edits locked to automation where possible; avoid user-induced regressions.
              </div>
            </div>
          </div>
        </section>

        <!-- STAKEHOLDER CONTACTS -->
        <section id="stakeholders">
          <h2>
            Stakeholder Contacts
            <span class="badge">Key project contacts</span>
          </h2>
          <div class="stakeholder-grid">
            <div class="stakeholder-card">
              <div class="stakeholder-name">Angela O'Neill</div>
              <div class="stakeholder-role">Project Contact</div>
              <span class="stakeholder-org metajive">Metajive</span>
            </div>
            <div class="stakeholder-card">
              <div class="stakeholder-name">Ali Kendall</div>
              <div class="stakeholder-role">Sr Vice President, Marketing</div>
              <span class="stakeholder-org sor">School of Rock</span>
            </div>
            <div class="stakeholder-card">
              <div class="stakeholder-name">Colin Johnson</div>
              <div class="stakeholder-role">Technical Lead</div>
              <span class="stakeholder-org yeb">YEB</span>
            </div>
          </div>
        </section>

      </div>
    </main>

    <footer>
      <div class="footer-inner">
        <span>
          School of Rock HubSpot Forms Architecture & Discovery Tracker ¬∑ Data saved in browser localStorage
        </span>
        <span id="last-updated"></span>
      </div>
    </footer>
  </div>
</body>

<!-- Diagram Modal -->
<div class="diagram-modal" id="diagram-modal">
  <div class="diagram-modal-content">
    <div class="diagram-modal-header">
      <div class="diagram-modal-title" id="diagram-modal-title">Diagram</div>
      <div class="diagram-controls">
        <button class="diagram-btn" id="zoom-out">-</button>
        <button class="diagram-btn" id="zoom-reset">Reset</button>
        <button class="diagram-btn" id="zoom-in">+</button>
        <button class="diagram-btn" id="diagram-close">Close</button>
      </div>
    </div>
    <div class="diagram-modal-body">
      <div class="diagram-viewer" id="diagram-viewer">
        <div class="diagram-viewer-inner" id="diagram-viewer-inner"></div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.5/dist/mermaid.min.js"></script>
<script>
  // Mermaid initialization
  if (window.mermaid) {
    mermaid.initialize({
      startOnLoad: true,
      theme: "dark",
      securityLevel: "loose",
      flowchart: { htmlLabels: true, useMaxWidth: false },
      themeVariables: {
        primaryColor: "#0b1224",
        primaryBorderColor: "#e92b2d",
        primaryTextColor: "#f8fafc",
        lineColor: "#e92b2d",
        secondaryColor: "#0f172a",
      },
    });
  }

  // Diagram modal functionality
  (function() {
    const modal = document.getElementById("diagram-modal");
    const titleEl = document.getElementById("diagram-modal-title");
    const viewer = document.getElementById("diagram-viewer");
    const viewerInner = document.getElementById("diagram-viewer-inner");
    const btnClose = document.getElementById("diagram-close");
    const btnIn = document.getElementById("zoom-in");
    const btnOut = document.getElementById("zoom-out");
    const btnReset = document.getElementById("zoom-reset");
    const openers = document.querySelectorAll(".diagram-open");

    let scale = 1;
    let translateX = 0;
    let translateY = 0;
    let isPanning = false;
    let startX = 0;
    let startY = 0;

    function applyTransform() {
      viewerInner.style.transform = `translate(calc(-50% + ${translateX}px), calc(-50% + ${translateY}px)) scale(${scale})`;
    }

    function resetView() {
      scale = 1;
      translateX = 0;
      translateY = 0;
      applyTransform();
    }

    openers.forEach((btn) => {
      btn.addEventListener("click", () => {
        const targetId = btn.getAttribute("data-target");
        const title = btn.getAttribute("data-title") || "Diagram";
        const src = document.getElementById(targetId);
        if (!src) return;
        titleEl.textContent = title;
        viewerInner.innerHTML = src.innerHTML;
        resetView();
        modal.classList.add("active");
      });
    });

    btnClose.addEventListener("click", () => {
      modal.classList.remove("active");
    });

    btnIn.addEventListener("click", () => {
      scale = scale + 0.2;
      applyTransform();
    });

    btnOut.addEventListener("click", () => {
      scale = Math.max(scale - 0.2, 0.05);
      applyTransform();
    });

    btnReset.addEventListener("click", resetView);

    viewer.addEventListener("wheel", (e) => {
      e.preventDefault();
      const delta = e.deltaY > 0 ? -0.1 : 0.1;
      scale = Math.max(scale + delta, 0.05);
      applyTransform();
    }, { passive: false });

    viewer.addEventListener("mousedown", (e) => {
      isPanning = true;
      startX = e.clientX;
      startY = e.clientY;
    });

    window.addEventListener("mousemove", (e) => {
      if (!isPanning) return;
      translateX += (e.clientX - startX);
      translateY += (e.clientY - startY);
      startX = e.clientX;
      startY = e.clientY;
      applyTransform();
    });

    window.addEventListener("mouseup", () => {
      isPanning = false;
    });

    modal.addEventListener("click", (e) => {
      if (e.target === modal) {
        modal.classList.remove("active");
      }
    });
  })();

  // Discovery tracker state management
  const STORAGE_KEY = 'sor_discovery_state';
  const TOTAL_QUESTIONS = 10;

  let state = {
    questions: {},
    lastUpdated: null
  };

  // Load state from localStorage
  function loadState() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      try {
        state = JSON.parse(saved);
        applyState();
      } catch (e) {
        console.error('Failed to load state:', e);
      }
    }
    updateProgress();
    updateLastUpdated();
  }

  // Save state to localStorage
  function saveState() {
    state.lastUpdated = Date.now();
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    updateLastUpdated();
  }

  // Apply loaded state to UI
  function applyState() {
    for (const [qId, qData] of Object.entries(state.questions)) {
      const item = document.querySelector(`[data-id="${qId}"]`);
      if (!item) continue;

      const checkbox = item.querySelector('.question-check');
      const statusBadge = document.getElementById(`status-${qId}`);
      const textarea = document.getElementById(`text-${qId}`);

      if (checkbox && qData.checked) {
        checkbox.checked = true;
        item.classList.add('answered');
      }

      if (statusBadge && qData.checked) {
        statusBadge.textContent = 'Answered';
        statusBadge.className = 'status-badge answered';
      }

      if (textarea && qData.answer) {
        textarea.value = qData.answer;
      }
    }
  }

  // Update question state
  function updateQuestion(qId) {
    const item = document.querySelector(`[data-id="${qId}"]`);
    const checkbox = item.querySelector('.question-check');
    const statusBadge = document.getElementById(`status-${qId}`);

    if (!state.questions[qId]) {
      state.questions[qId] = { checked: false, answer: '' };
    }

    state.questions[qId].checked = checkbox.checked;

    if (checkbox.checked) {
      item.classList.add('answered');
      statusBadge.textContent = 'Answered';
      statusBadge.className = 'status-badge answered';
    } else {
      item.classList.remove('answered');
      statusBadge.textContent = 'Pending';
      statusBadge.className = 'status-badge pending';
    }

    saveState();
    updateProgress();
  }

  // Toggle answer area visibility
  function toggleAnswer(qId) {
    const answerArea = document.getElementById(`answer-${qId}`);
    const btn = answerArea.previousElementSibling;

    if (answerArea.style.display === 'none') {
      answerArea.style.display = 'block';
      btn.textContent = '- Hide Answer';
    } else {
      answerArea.style.display = 'none';
      btn.textContent = '+ Answer';
    }
  }

  // Save answer text
  function saveAnswer(qId) {
    const textarea = document.getElementById(`text-${qId}`);

    if (!state.questions[qId]) {
      state.questions[qId] = { checked: false, answer: '' };
    }

    state.questions[qId].answer = textarea.value;
    saveState();
  }

  // Update progress display
  function updateProgress() {
    const answered = Object.values(state.questions).filter(q => q.checked).length;
    const percent = (answered / TOTAL_QUESTIONS) * 100;

    document.getElementById('progress-count').textContent = `${answered} / ${TOTAL_QUESTIONS}`;
    document.getElementById('progress-fill').style.width = `${percent}%`;
  }

  // Update last updated timestamp
  function updateLastUpdated() {
    const el = document.getElementById('last-updated');
    if (state.lastUpdated) {
      const date = new Date(state.lastUpdated);
      el.textContent = `Last updated: ${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
    }
  }

  // Export data as JSON
  function exportData() {
    const dataStr = JSON.stringify(state, null, 2);
    const blob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `sor_discovery_${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);
  }

  // Import data from JSON file
  function importData(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        state = JSON.parse(e.target.result);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        applyState();
        updateProgress();
        updateLastUpdated();
        alert('Data imported successfully!');
      } catch (err) {
        alert('Failed to import: Invalid JSON file');
      }
    };
    reader.readAsText(file);
  }

  // Clear all data
  function clearAllData() {
    if (confirm('Are you sure you want to clear all answers and progress? This cannot be undone.')) {
      localStorage.removeItem(STORAGE_KEY);
      state = { questions: {}, lastUpdated: null };

      // Reset UI
      document.querySelectorAll('.question-item').forEach(item => {
        item.classList.remove('answered');
        const checkbox = item.querySelector('.question-check');
        if (checkbox) checkbox.checked = false;
      });

      document.querySelectorAll('.status-badge').forEach(badge => {
        badge.textContent = 'Pending';
        badge.className = 'status-badge pending';
      });

      document.querySelectorAll('.answer-area textarea').forEach(textarea => {
        textarea.value = '';
      });

      updateProgress();
      document.getElementById('last-updated').textContent = '';
    }
  }

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', loadState);
</script>
</html>
